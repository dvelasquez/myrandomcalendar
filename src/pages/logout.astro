---
import { auth } from '../features/auth/lib/better-auth';

export const prerender = false; // Required for server-side operations

// Get user from middleware
const { user } = Astro.locals;

// If user is logged in, perform logout using BetterAuth API
if (user) {
  try {
    await auth.api.signOut({
      headers: Astro.request.headers,
    });
  } catch (error) {
    console.error('Logout error:', error);
    // Continue with redirect even if logout fails
  }
}

// Redirect to home page after logout
return Astro.redirect('/');
---
